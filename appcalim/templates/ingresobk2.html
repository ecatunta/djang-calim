{% extends 'inicio.html' %}

{% load static %}

{% block title %}
Ingreso
{% endblock %}

{% block content %}

<section id="pricing" class="pricing section light-background">
    <div class="container mt-5" style="margin-top: 50px;">

        <form method="post" action="{% url 'nuevo_ingreso' %}" class="venta-form">
            {% csrf_token %}
            <div class="row row-producto mb-4">
                <div class="col-12 text-center" style="position: relative;">

                    <div class="input-group mb-3 search-bar-container" id="search-bar-container">
                        <!-- Ícono de búsqueda, visible por defecto -->
                        <span class="input-group-text" id="search-icon">
                            <i class="bi bi-search"></i>
                        </span>

                        <!-- Ícono de la flecha hacia la izquierda, oculto por defecto -->
                        <span class="input-group-text" id="back-arrow" style="display: none;">
                            <i class="bi bi-arrow-left"></i>
                        </span>

                        <input type="text" id="producto" name="producto" class="form-control" placeholder="Buscar..."
                            aria-label="Buscar producto">
                        <input type="hidden" id="id_producto_id" name="producto_id">
                    </div>

                    <ul id="suggestions" class="list-group mt-1" style="display: none;"></ul>

                </div>
            </div>

            <div class="row row-campos mb-3">
                <!-- Columna de "Unidad" -->
                <div class="col-md-2 col-4 d-flex flex-column justify-content-center text-center">
                    <label for="id_ingreso_unidad" class="form-label d-none d-md-block">Unidad</label>
                    <label for="id_ingreso_unidad" class="form-label d-md-none">Uni</label>
                    <input type="number" id="id_ingreso_unidad" name="ingreso_unidad"
                        class="form-control v-placeholder text-center" placeholder="Unidades">
                </div>

                <!-- Columna de "Costo Unidad" -->
                <div class="col-md-2 col-4 d-flex flex-column justify-content-center text-center">
                    <label for="id_ingreso_costoU" class="form-label d-none d-md-block">Costo Unidad</label>
                    <label for="id_ingreso_costoU" class="form-label d-md-none">$ C/u</label>
                    <input type="number" id="id_ingreso_costoU" name="ingreso_costoUnitario"
                        class="form-control v-placeholder text-center" placeholder="Costo Unidad" step="any">
                </div>

                <!-- Columna de "Costo Total" -->
                <div class="col-md-2 col-4 d-flex flex-column justify-content-center text-center">
                    <label for="id_ingreso_costoT" class="form-label d-none d-md-block">Costo Total ($)</label>
                    <label for="id_ingreso_costoT" class="form-label d-md-none">Total ($)</label>
                    <input type="text" id="id_ingreso_costoT" name="ingreso_costoTotal"
                        class="form-control disabled-input v-placeholder text-center" placeholder="Costo Total"
                        readonly>
                </div>

                <!-- Columna de "Detalle" -->
                <div class="col-md-4 col-12 d-flex flex-column justify-content-center text-center mt-3 mt-md-0">
                    <label for="id_ingreso_referencia" class="form-label">Detalle</label>
                    <input type="text" id="id_ingreso_referencia" name="ingreso_referencia"
                        class="form-control v-placeholder" placeholder="Descripción">
                </div>

                <!-- Botón de "Adicionar" -->
                <div class="col-md-2 col-12 d-flex align-items-center justify-content-center mt-3 mt-md-0">
                    <button type="submit" id="btn_adicionar" class="btn btn-primary w-100" style="height:80px;"
                        disabled>Adicionar</button>
                </div>
            </div>
        </form>

        <div class="row row-tabla-ventas">
            <div class="col-12">
                <div class="table-responsive">
                    <table id="ingreso_tabla" class="table table-bordered table-hover table-striped">
                        <thead class="thead-dark text-center">
                            <tr>
                                <th style="width: 100px;">Unidad</th>
                                <th style="width: 50%;">Producto</th>
                                <th class="text-end" style="width: 170px;">Costo Unitario</th>
                                <th class="text-end">Costo Total</th>
                                <th class="text-center">Accion</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for ingreso in ingresos %}
                            <tr data-ingreso-id="{{ ingreso.ingreso_id }}">
                                <td style="width: 80px; vertical-align: middle;">
                                    <input type="number" class="form-control" value="{{ ingreso.ingreso_unidad }}"
                                        data-role="unidad_number">
                                </td>
                                <td style="vertical-align: middle;">{{ ingreso.producto }}</td>
                                <td class="text-end" style="vertical-align: middle;">
                                    <input type="number" class="form-control"
                                        value="{{ ingreso.ingreso_costoUnitario }}" data-role="costo_unitario_number">
                                </td>
                                <td class="text-end costo_total" style="vertical-align: middle;">
                                    {{ ingreso.ingreso_costoTotal }}
                                </td>
                                <td class="text-center" style="vertical-align: middle;">
                                    <button class="inventario_ingreso">Inventario</button>
                                    <button class="ingreso_quitar">Quitar</button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>



<script src="{% static 'js/cookie.js' %}"></script>
<script src="{% static 'js/busqueda.js' %}"></script>

{% endblock %}